# 1UP Configuration - Local Development

camera:
  index: 1  # Preferred: 0 = built-in, 1 = C270 USB camera, 1-2 = iPhone Camera (will fallback to available camera if not found)
  resolution: [1920, 1080]
  fps: 5
  allow_iphone: true  # Set to true to allow iPhone/Continuity Camera (default: false to avoid interfering with phone)
  # Note: If you set index to 1 or 2 (iPhone), it will be used even if allow_iphone is false
  # If preferred camera not found, system will use any available camera as fallback

sam3:
  device: "mps"  # Mac M2 GPU. Use "cuda" on NVIDIA, "cpu" on Pi
  
  # SAM 3 uses text prompts for concept-based detection
  # Leave empty for automatic detection (uses "visual" prompt internally)
  # Or specify concepts like: "bag", "shoes", "electronics", "furniture", "rectangle", "shape", "round", "dark object"
  # Note: For better detection of dark/round objects (like kettlebell), try: "round object" or "dark object"
  text_prompt: ""  # Empty = automatic detection, or specify concept
  
  # Image enhancement (improves detection of dark objects)
  enhance_image: true  # CLAHE pre-processing - ACTIVADO para detectar objetos oscuros (kettlebell, etc.)
  
  # Smart filtering (PRE-Claude, reduces false positives before generating crops)
  # FIX 1: Umbrales más permisivos para detectar más objetos en condiciones reales
  filtering:
    enabled: true  # Enable smart filtering in detector (recommended)
    min_area: 200  # Minimum object area in pixels² (REDUCED from 500 to detect más objetos pequeños)
    max_area_ratio: 0.4  # Maximum area as ratio of image (40%, INCREASED from 0.3 para no filtrar objetos grandes válidos)
    min_aspect_ratio: 0.05  # Minimum width/height ratio (REDUCED from 0.1 para objetos muy alargados)
    max_aspect_ratio: 10.0  # Maximum width/height ratio (INCREASED from 8.0 para objetos muy largos)
    nms_iou_threshold: 0.5  # NMS threshold (INCREASED from 0.2 to 0.5, más agresivo para eliminar duplicados y sobre-segmentación)
  
  # Pre-filtering before Claude analysis (reduce noise and API costs)
  # FIX 1: Reducir umbral para enviar más objetos a Claude
  min_area_for_analysis: 200  # Only send objects > 200px² to Claude (REDUCED from 500 para detectar más objetos)

claude:
  api_key_env: "CLAUDE_API_KEY"  # Read from environment variable
  model: "claude-sonnet-4-20250514"
  max_tokens: 16000  # Increased for large batches (255 objects need ~15k tokens)
  temperature: 0  # Deterministic output

paths:
  raw_images: "images/raw"
  crops: "images/crops"
  database: "database/objects.json"

cleanup:
  enabled: false  # Automatic cleanup disabled by default (scenes may be valuable long-term)
  keep_days: 30  # If enabled, keep scenes from last N days
  keep_useful_only: true  # Only keep crops from useful objects (in database)
  # Note: Use cleanup_images.py manually if needed

# Testing mode: Auto-delete images at startup only (for development/testing only)
testing:
  auto_cleanup: true  # ⚠️ TESTING MODE: Clean at startup, keep images during session
  # Images are deleted at startup, but kept during session for web display
  # Set to false to keep images permanently

logging:
  level: "INFO"  # DEBUG | INFO | WARNING | ERROR
  format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"

